import{r as d,j as t}from"../chunks/chunk-53cb423e.js";import{c as O,A as V,u as D,F as w,T as H,a as A,b as K,d as P,I as C,f as M,B as U,e as W,g as q}from"../chunks/chunk-6d35d077.js";import{n as B}from"../chunks/chunk-032b5b1b.js";import{u as J,c as $}from"../chunks/chunk-ec9663c0.js";import{u as Q,c as X,f as k,a as Y,o as T,b as I,d as N,e as Z,I as L}from"../chunks/chunk-eee88d9b.js";import"../chunks/chunk-af981888.js";function j(e){const{theme:a}=Q(),n=J();return d.useMemo(()=>$(a.direction,{...n,...e}),[e,a.direction,n])}function ee(e){return d.Children.toArray(e).filter(a=>d.isValidElement(a))}var[te,re]=X({name:"InputGroupStylesContext",errorMessage:`useInputGroupStyles returned is 'undefined'. Seems you forgot to wrap the components in "<InputGroup />" `}),_=k(function(a,n){const i=Y("Input",a),{children:s,className:c,...g}=T(a),u=I("chakra-input__group",c),r={},p=ee(s),f=i.field;p.forEach(l=>{var m,y;i&&(f&&l.type.id==="InputLeftElement"&&(r.paddingStart=(m=f.height)!=null?m:f.h),f&&l.type.id==="InputRightElement"&&(r.paddingEnd=(y=f.height)!=null?y:f.h),l.type.id==="InputRightAddon"&&(r.borderEndRadius=0),l.type.id==="InputLeftAddon"&&(r.borderStartRadius=0))});const S=p.map(l=>{var m,y;const o=O({size:((m=l.props)==null?void 0:m.size)||a.size,variant:((y=l.props)==null?void 0:y.variant)||a.variant});return l.type.id!=="Input"?d.cloneElement(l,o):d.cloneElement(l,Object.assign(o,r,l.props))});return t.jsx(N.div,{className:u,ref:n,__css:{width:"100%",display:"flex",position:"relative",isolation:"isolate"},"data-group":!0,...g,children:t.jsx(te,{value:i,children:S})})});_.displayName="InputGroup";var ae=N("div",{baseStyle:{display:"flex",alignItems:"center",justifyContent:"center",position:"absolute",top:"0",zIndex:2}}),E=k(function(a,n){var i,s;const{placement:c="left",...g}=a,u=re(),r=u.field,f={[c==="left"?"insetStart":"insetEnd"]:"0",width:(i=r==null?void 0:r.height)!=null?i:r==null?void 0:r.h,height:(s=r==null?void 0:r.height)!=null?s:r==null?void 0:r.h,fontSize:r==null?void 0:r.fontSize,...u.element};return t.jsx(ae,{ref:n,__css:f,...g})});E.id="InputElement";E.displayName="InputElement";var v=k(function(a,n){const{className:i,...s}=a,c=I("chakra-input__left-element",i);return t.jsx(E,{ref:n,placement:"left",className:c,...s})});v.id="InputLeftElement";v.displayName="InputLeftElement";var z=k(function(a,n){const{className:i,...s}=a,c=I("chakra-input__right-element",i);return t.jsx(E,{ref:n,placement:"right",className:c,...s})});z.id="InputRightElement";z.displayName="InputRightElement";var G=k(function(a,n){const{className:i,centerContent:s,...c}=T(a),g=Z("Container",a);return t.jsx(N.div,{ref:n,className:I("chakra-container",i),...c,__css:{...g,...s&&{display:"flex",flexDirection:"column",alignItems:"center"}}})});G.displayName="Container";var ne={prefix:"far",iconName:"file",icon:[384,512,[128196,128459,61462],"f15b","M320 464c8.8 0 16-7.2 16-16V160H256c-17.7 0-32-14.3-32-32V48H64c-8.8 0-16 7.2-16 16V448c0 8.8 7.2 16 16 16H320zM0 64C0 28.7 28.7 0 64 0H229.5c17 0 33.3 6.7 45.3 18.7l90.5 90.5c12 12 18.7 28.3 18.7 45.3V448c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V64z"]};const se=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function ie(e){return!!e.match(se)}function le(e){if(typeof e!="object"||e==null||!("version"in e)||e.version!==3||!("id"in e)||typeof e.id!="string"||!ie(e.id)||!("address"in e)||typeof e.address!="string")return!1;try{V.fromHex(e.address,!0)}catch{return!1}return"crypto"in e&&typeof e.crypto=="object"&&oe(e.crypto)&&ce(e.crypto)}function oe(e){return typeof e=="object"&&e!=null&&"cipher"in e&&e.cipher==="aes-128-ctr"&&"cipherparams"in e&&typeof e.cipherparams=="object"&&e.cipherparams!=null&&"iv"in e.cipherparams&&typeof e.cipherparams.iv=="string"&&"ciphertext"in e&&typeof e.ciphertext=="string"&&"mac"in e&&typeof e.mac=="string"}function ce(e){if(typeof e!="object"||e==null||!("kdf"in e))return!1;switch(e.kdf){case"pbkdf2":return"kdfparams"in e&&typeof e.kdfparams=="object"&&e.kdfparams!=null&&"c"in e.kdfparams&&typeof e.kdfparams.c=="number"&&"dklen"in e.kdfparams&&typeof e.kdfparams.dklen=="number"&&"prf"in e.kdfparams&&e.kdfparams.prf==="hmac-sha256"&&"salt"in e.kdfparams&&typeof e.kdfparams.salt=="string";case"scrypt":return"kdfparams"in e&&typeof e.kdfparams=="object"&&e.kdfparams!=null&&"dklen"in e.kdfparams&&typeof e.kdfparams.dklen=="number"&&"n"in e.kdfparams&&typeof e.kdfparams.n=="number"&&"p"in e.kdfparams&&typeof e.kdfparams.p=="number"&&"r"in e.kdfparams&&typeof e.kdfparams.r=="number"&&"salt"in e.kdfparams&&typeof e.kdfparams.salt=="string";default:return!1}}function he(){var l,m,y;const[e,a]=D(q),[n,i]=d.useState(),[s,c]=d.useState(""),[g,u]=d.useState(!1),r=d.useRef(null),p=j();function f(){var b;const o=(b=r.current)==null?void 0:b.files;if(!o||o.length!==1){p({title:"Error",description:"No keyfile has been selected.",status:"error"});return}const h=o[0],x=new FileReader;x.onload=()=>{const R=x.result;if(typeof R!="string"){p({title:"Error",description:"Failed to read keyfile.",status:"error"});return}const F=JSON.parse(R);if(!le(F)){p({title:"Error",description:"Keyfile is not in valid Web3 Secret Storage Format.",status:"error"});return}i(F)},x.readAsText(h)}const S=async o=>{if(o.preventDefault(),u(!0),!n){u(!1),p({title:"Error",description:"No keyfile has been imported.",status:"error"});return}if(!s){u(!1),p({title:"Error",description:"Please enter your passphrase.",status:"error"});return}try{const h=W(n,()=>s),x=await h.getPublicKey(),b=await h.getAddress();a({account:h,publicKey:x,address:b}),B("/main")}catch(h){if(u(!1),!(h instanceof Error)){p({title:"Error",description:"Unknown error occured while getting account from key file. Please try again.",status:"error"});return}p({title:"Error",description:h.message,status:"error"})}u(!1)};return t.jsxs(G,{as:w,flexDir:"column",rounded:"2xl",shadow:"2xl",p:"6",gap:"4",children:[t.jsx(H,{}),t.jsxs(w,{as:"form",gap:"3",flexDir:"column",onSubmit:S,children:[t.jsxs(A,{isRequired:!0,children:[t.jsx(K,{children:"Web3 Secret Storage File"}),t.jsxs(_,{children:[t.jsx(v,{pointerEvents:"none",children:t.jsx(L,{as:P,icon:ne,textColor:"gray.500"})}),t.jsx(C,{type:"text",readOnly:!0,value:n?((y=(m=(l=r.current)==null?void 0:l.files)==null?void 0:m.item(0))==null?void 0:y.name)??"":"",placeholder:"Select a keyfile...",onChange:()=>{},onClick:()=>r.current&&r.current.click()})]})]}),t.jsxs(A,{isRequired:!0,children:[t.jsx(K,{children:"Passphrase"}),t.jsxs(_,{children:[t.jsx(v,{pointerEvents:"none",children:t.jsx(L,{as:P,icon:M,textColor:"gray.500"})}),t.jsx(C,{type:"password",value:s,onChange:o=>c(o.target.value),placeholder:"Passphrase",disabled:!e})]})]}),t.jsx(C,{type:"file",display:"none",ref:r,onChange:o=>{o.target.files&&o.target.files.length===1&&f()}}),t.jsx(U,{w:"full",type:"submit",isDisabled:!e||!s,isLoading:g,children:"Authenticate"})]})]})}export{he as Page};
